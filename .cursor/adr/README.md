# 架构决策记录 (Architecture Decision Records)

## 什么是ADR？

架构决策记录(ADR)是一种轻量级方法，用于记录对项目产生重大影响的技术决策。每个ADR文档简洁地描述：

- 决策的**背景**（为什么需要做决定）
- 所做的**决策**（具体选择了什么）
- 决策的**后果**（这会带来什么影响）

## 为什么使用ADR？

- **知识传承**：新团队成员可以快速了解历史决策原因
- **减少重复讨论**：避免反复讨论已解决的问题
- **决策透明**：清晰记录决策过程和理由
- **冲突预防**：减少"为什么我们要这样做？"的疑问

## Semi-Auto ADR工作流

我们采用半自动化ADR流程，集成到Plan-Execute循环中：

1. 当做出重要架构决策时（通常在Planner阶段），立即创建ADR
2. 使用`tools/adr_init.sh`脚本生成ADR模板
3. 在Plan-Execute模板中引用ADR链接
4. ADR创建后，自动更新当前循环的`[🔖 ADR LINK]`字段

## 何时创建ADR？

符合以下标准的决策应创建ADR：

- **重大影响**：影响多个组件或整体架构
- **难以逆转**：更改成本高昂或复杂
- **非显而易见**：未来开发者可能会问"为什么选择这个方案？"
- **有替代方案**：在多个可行选项中做出选择

## ADR文件格式

ADR文件遵循以下命名约定：`YYYYMMDD_短标题.md`，例如：`20250506_semi_auto_adr_workflow.md`

每个ADR包含：

```markdown
# ADR-NNNN: 标题

## 状态
[提议|已接受|已废弃|已取代|...]

## 背景
[描述问题和上下文...]

## 决策
[描述所做的决定...]

## 后果
[描述决策带来的影响、风险和机会...]

## 相关循环
- Cycle X (#相关PR链接)
```

## ADR工具

- **创建新ADR**：`./tools/adr_init.sh "决策标题"`
- **查看ADR索引**：`README.md`或项目文档站点
- **ADR验证**：通过CI流程自动验证ADR格式和引用

## ADR与Plan-Execute循环集成

每个Plan-Execute循环都在`[🔖 ADR LINK]`字段中包含对相关ADR的引用。这确保了:

1. 架构决策可追溯到特定循环
2. 当前循环文档化了相关决策
3. 实现与设计文档保持一致 