# ADR-0002: Adopt VS Code extension framework

## 状态
已接受

## 背景
<!-- 描述问题和上下文 -->
Oppie.xyz项目需要一个便捷的用户界面，让开发者能够从IDE中直接启动和监控Plan-Execute循环。当前的命令行界面要求用户在终端中执行脚本，缺乏直观的状态反馈和便捷的触发机制。此外，随着项目功能的扩展（例如新的ADR功能），需要一个集成化的界面来展示和管理这些功能。

VS Code作为当前最流行的代码编辑器之一，为扩展提供了全面的API，能够实现状态栏指示器、命令面板集成、侧边栏视图等功能，非常适合作为Oppie.xyz的GUI前端。

## 决策
<!-- 描述所做的决定 -->
我们决定采用VS Code扩展框架，使用TypeScript作为开发语言，为Oppie.xyz项目创建一个专用扩展。扩展的初始版本（MVP）将包含以下核心功能：

1. 命令面板中的"Oppie.xyz: Run Plan-Execute Cycle"命令，用于触发Plan-Execute循环
2. 状态栏指示器，显示最近一次循环的编号和成功/失败状态
3. 与现有的Plan-Execute循环脚本集成，使用本地状态文件（.cursor/state.json）进行状态同步

我们选择使用Yeoman生成器（yo code）创建扩展脚手架，使用webpack进行打包，并设置GitHub工作流进行自动构建、测试和打包。

## 后果
<!-- 描述决策带来的影响、风险和机会 -->
### 积极影响
1. 提高用户体验，使Oppie.xyz更易于使用和监控
2. 为未来功能（如ADR查看器、Vector Store索引器）提供统一的UI框架
3. 便于集成到开发者工作流程中，无需离开IDE即可操作
4. 提高项目的专业性和可见度

### 风险和挑战
1. 增加了维护成本，需要同时维护命令行工具和VS Code扩展
2. VS Code API版本更新可能需要适配
3. 扩展激活事件需要优化，避免不必要的性能开销
4. 需要确保跨平台兼容性

### 缓解措施
1. 采用共享的核心库，减少代码重复
2. 使用配置文件驱动开发，使扩展和CLI行为保持一致
3. 实施全面的自动化测试，确保功能稳定性
4. 限制初始版本的功能范围，先实现核心功能再逐步扩展

## 相关循环
<!-- 关联的Plan-Execute循环编号和PR链接 -->
- Cycle 3: 开发VS Code扩展基础框架
- ADR链接: .cursor/adr/20250506_adopt_vs_code_extension_framework.md
